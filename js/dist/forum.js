(()=>{var t={n:r=>{var o=r&&r.__esModule?()=>r.default:()=>r;return t.d(o,{a:o}),o},d:(r,o)=>{for(var e in o)t.o(o,e)&&!t.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:o[e]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};(()=>{"use strict";t.r(r);const o=flarum.core.compat["common/app"];function e(t,r){return e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},e(t,r)}t.n(o)().initializers.add("rob006/flarum-ext-last-post-avatar",(function(){}));const s=flarum.core.compat["forum/app"];var a=t.n(s);const n=flarum.core.compat["common/extend"],i=flarum.core.compat["forum/components/TerminalPost"];var c=t.n(i);const u=flarum.core.compat["common/helpers/avatar"];var l=t.n(u);const p=flarum.core.compat["common/helpers/humanTime"];var f=t.n(p);const d=flarum.core.compat["common/helpers/icon"];var v=t.n(d);const P=flarum.core.compat["forum/components/DiscussionListItem"];var y=t.n(P);const h=flarum.core.compat["common/components/Link"];var b=t.n(h);const _=flarum.core.compat["common/components/Tooltip"];var g=t.n(_),A=function(t){var r,o;function s(){return t.apply(this,arguments)||this}return o=t,(r=s).prototype=Object.create(o.prototype),r.prototype.constructor=r,e(r,o),s.prototype.view=function(){var t=a().forum.attribute("lastPostAvatarMode"),r=this.attrs.discussion,o=this.attrs.lastPost&&r.replyCount(),e=r[o?"lastPostedUser":"user"](),s=r[o?"lastPostedAt":"createdAt"](),n="all-replies"===t&&o||"always"===t||"non-op-replies"===t&&r.lastPostedUser()!=r.user();return n&&(n=!a().forum.attribute("lastPostAvatarIgnorePrivateDiscussions")||!(null!=r.isPrivateDiscussion&&r.isPrivateDiscussion())),m("span",null,o?v()("fas fa-reply"):""," ",n?l()(e,{className:"ComposerBody-lastPostAvatar"+(o?" reply-avatar":"")}):"",a().translator.trans("core.forum.discussion_list."+(o?"replied":"started")+"_text",{user:e,ago:f()(s)}))},s}(c());a().initializers.add("rob006/flarum-ext-last-post-avatar",(function(){(0,n.extend)(y().prototype,"infoItems",(function(t){"replace-main"!==a().forum.attribute("lastPostAvatarMode")&&t.replace("terminalPost",A.component({discussion:this.attrs.discussion,lastPost:!this.showFirstPost()}))})),(0,n.override)(y().prototype,"view",(function(t){var r=t(),o=this.attrs.discussion,e=!this.showFirstPost()&&o.replyCount();if("replace-main"!==a().forum.attribute("lastPostAvatarMode")||a().forum.attribute("lastPostAvatarIgnorePrivateDiscussions")&&null!=o.isPrivateDiscussion&&o.isPrivateDiscussion()||!e)return r;var s=o.lastPostedUser();return function t(r){if(r&&r.children&&Array.isArray(r.children)){var n=r.children.find((function(t){return t&&t.attrs&&t.attrs.className&&String(t.attrs.className).split(" ").includes("DiscussionListItem-content")}));if(n)return void n.children.splice(0,1,m(g(),{text:a().translator.trans("core.forum.discussion_list.replied_text",{user:s,ago:f()(o.createdAt())}),position:"right"},m(b(),{className:"DiscussionListItem-author"+(e?" reply-avatar":""),href:s?a().route.user(s):"#"},l()(s||null,{title:""}))));r.children.forEach((function(r){t(r)}))}}(r),r}))}))})(),module.exports=r})();
//# sourceMappingURL=forum.js.map